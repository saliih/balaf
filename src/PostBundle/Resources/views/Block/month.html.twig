{% extends 'SonataBlockBundle:Block:block_base.html.twig' %}



{% block block %}

    <div class="box ">

        <div class="box-header">
            <h3 class="box-title"> {{ title }}</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>

                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
            </div>
        </div>

        <div class="box-body">
            <div id="month-chart" style="height: 225px;"></div>
        </div>

    </div>
    <script>
        $(function () {
           {% set i=1 %}{% for user in final %} var bar_data{{ i }} = [];{% set i=i+1 %}{% endfor %}
            {% set i=1 %}
            {% for user in final %}
            {% for key,item in user %}
            bar_data{{ i }}.push([{{ key }}, {{ item }}]);
            {% endfor %}
            {% set i=i+1 %}
            {% endfor %}

            var stack = true,
                    bars = true,
                    lines = false,
                    steps = false;
            function plotWithOptions() {
                $.plot("#month-chart", [{% set i=1 %}{% for user in final %}bar_data{{ i }},{% set i=i+1 %}{% endfor %}], {
                    series: {
                        stack: stack,
                        lines: {
                            show: lines,
                            fill: true,
                            steps: steps
                        },
                        bars: {
                            show: bars,
                            barWidth: 0.6
                        }
                    }
                });
            }

            plotWithOptions();

        });
    </script>
{% endblock %}